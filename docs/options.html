<!DOCTYPE html>

<html>
<head>
  <title>options.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="analytics.html">
                analytics.coffee
              </a>
            
              
              <a class="source" href="content.html">
                content.coffee
              </a>
            
              
              <a class="source" href="events.html">
                events.coffee
              </a>
            
              
              <a class="source" href="i18n.html">
                i18n.coffee
              </a>
            
              
              <a class="source" href="injector.html">
                injector.coffee
              </a>
            
              
              <a class="source" href="install.html">
                install.coffee
              </a>
            
              
              <a class="source" href="models.html">
                models.coffee
              </a>
            
              
              <a class="source" href="options.html">
                options.coffee
              </a>
            
              
              <a class="source" href="utils.html">
                utils.coffee
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>options.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p><a href="http://neocotic.com/injector">Injector</a></p>
<p>(c) 2014 Alasdair Mercer</p>
<p>Freely distributable under the MIT license</p>

            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>Extract any models and collections that are required by the options page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>{Snippet} = models</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <h2 id="feedback">Feedback</h2>

            </div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Indicate whether the user feedback feature has been added to the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>feedbackAdded = <span class="hljs-literal">no</span></pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Add the user feedback feature to the page using the <code>options</code> provided.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-title">loadFeedback</span> = <span class="hljs-params">(options)</span> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Only load and configure the feedback widget once.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> feedbackAdded</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Create a script element to load the UserVoice widget.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  uv       = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">'script'</span>)
  uv.async = <span class="hljs-literal">yes</span>
  uv.src   = <span class="hljs-string">"https://widget.uservoice.com/<span class="hljs-subst">#{options.id}</span>.js"</span></pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Insert the script element into the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  script = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'script'</span>)
  script.parentNode.insertBefore(uv, script)</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Configure the widget as it’s loading.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  UserVoice = <span class="hljs-built_in">window</span>.UserVoice <span class="hljs-keyword">or</span>= []
  UserVoice.push [
    <span class="hljs-string">'showTab'</span>
    <span class="hljs-string">'classic_widget'</span>
    {
      <span class="hljs-attribute">mode</span>:          <span class="hljs-string">'full'</span>
      <span class="hljs-attribute">primary_color</span>: <span class="hljs-string">'#333'</span>
      <span class="hljs-attribute">link_color</span>:    <span class="hljs-string">'#08c'</span>
      <span class="hljs-attribute">default_mode</span>:  <span class="hljs-string">'feedback'</span>
      <span class="hljs-attribute">forum_id</span>:      options.forum
      <span class="hljs-attribute">tab_label</span>:     i18n.get(<span class="hljs-string">'feedback_button'</span>)
      <span class="hljs-attribute">tab_color</span>:     <span class="hljs-string">'#333'</span>
      <span class="hljs-attribute">tab_position</span>:  <span class="hljs-string">'middle-right'</span>
      <span class="hljs-attribute">tab_inverted</span>:  <span class="hljs-literal">yes</span>
    }
  ]</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Ensure that the widget isn’t loaded again.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  feedbackAdded = <span class="hljs-literal">yes</span></pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <h2 id="editor">Editor</h2>

            </div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>View containing buttons for saving/resetting the code of the selected snippet from the contents
of the Ace editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>EditorControls = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <p>Overlay the editor controls on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#editor_controls'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Register DOM events for the editor controls</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'click #reset_button:not(:disabled)'</span>:  <span class="hljs-string">'reset'</span>
    <span class="hljs-string">'click #save_button:not(:disabled)'</span>: <span class="hljs-string">'save'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Render the editor controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@update</span>()

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Reset the Ace editor so that it is empty.</p>
<p>Nothing happens if there is no snippet selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">reset</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> <span class="hljs-property">@hasModel</span>()

    {ace} = <span class="hljs-property">@options</span>

    ace.setValue(<span class="hljs-property">@model</span>.get(<span class="hljs-string">'code'</span>))
    ace.gotoLine(<span class="hljs-number">0</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Save the contents of the Ace editor as the snippet code.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">save</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> <span class="hljs-property">@hasModel</span>()

    $button = $(event.currentTarget)
    code    = <span class="hljs-property">@options</span>.ace.getValue()

    $button.button(<span class="hljs-string">'loading'</span>).delay(<span class="hljs-number">500</span>)

    <span class="hljs-property">@model</span>.save({ code })
    .<span class="hljs-keyword">then</span><span class="hljs-function"> =&gt;</span>
      <span class="hljs-property">@model</span>.trigger(<span class="hljs-string">'modified'</span>, <span class="hljs-literal">no</span>, code)

      analytics.track(<span class="hljs-string">'Snippet'</span>, <span class="hljs-string">'Changed'</span>, <span class="hljs-string">'Code'</span>)

      $button.queue<span class="hljs-function"> -&gt;</span>
        $button.button(<span class="hljs-string">'reset'</span>).dequeue()</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Update the state of the editor controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@model</span>)</span> -&gt;</span>
    $buttons = <span class="hljs-property">@$</span>(<span class="hljs-string">'#reset_button, #save_button'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Ensure that specific buttons are only enabled when a snippet is selected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    $buttons.prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-keyword">not</span> <span class="hljs-property">@hasModel</span>())

}</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>A selection of available modes/languages that are supported by this extension for injecting
snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>EditorModes = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Overlay the editor modes on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#editor_modes'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Template for mode group option groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">groupTemplate</span>: _.template <span class="hljs-string">"""
    &lt;optgroup label="&lt;%- ctx.label %&gt;"&gt;&lt;/optgroup&gt;
  """</span></pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Template for mode options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">modeTemplate</span>: _.template <span class="hljs-string">"""
    &lt;option value="&lt;%- ctx.value %&gt;"&gt;&lt;%= ctx.html %&gt;&lt;/option&gt;
  """</span></pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Register DOM events for the editor modes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'change'</span>: <span class="hljs-string">'save'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>Render the editor modes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">for</span> name, modes <span class="hljs-keyword">of</span> Snippet.modeGroups
      <span class="hljs-keyword">do</span> <span class="hljs-function"><span class="hljs-params">(name, modes)</span> =&gt;</span>
        $group = $ <span class="hljs-property">@groupTemplate</span> {
          <span class="hljs-attribute">label</span>: i18n.get(<span class="hljs-string">"editor_mode_group_<span class="hljs-subst">#{name}</span>"</span>)
        }

        <span class="hljs-keyword">for</span> mode <span class="hljs-keyword">in</span> modes
          $group.append <span class="hljs-property">@modeTemplate</span> {
            <span class="hljs-attribute">html</span>:  i18n.get(<span class="hljs-string">"editor_mode_<span class="hljs-subst">#{mode}</span>"</span>)
            <span class="hljs-attribute">value</span>: mode
          }

        <span class="hljs-property">@$el</span>.append($group)

    <span class="hljs-property">@update</span>()

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Save the selected mode as the snippet mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">save</span>:<span class="hljs-function"> -&gt;</span>
    mode = <span class="hljs-property">@$el</span>.val()

    <span class="hljs-property">@options</span>.ace.getSession().setMode(<span class="hljs-string">"ace/mode/<span class="hljs-subst">#{mode}</span>"</span>)

    <span class="hljs-keyword">if</span> <span class="hljs-property">@hasModel</span>()
      analytics.track(<span class="hljs-string">'Snippet'</span>, <span class="hljs-string">'Changed'</span>, <span class="hljs-string">'Mode'</span>)

      <span class="hljs-property">@model</span>.save({ mode })</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>Update the state of the editor modes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@model</span>)</span> -&gt;</span>
    mode   = <span class="hljs-property">@model</span>?.get(<span class="hljs-string">'mode'</span>)
    mode <span class="hljs-keyword">or</span>= Snippet.defaultMode

    <span class="hljs-property">@$el</span>.prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-keyword">not</span> <span class="hljs-property">@hasModel</span>())

    <span class="hljs-property">@$</span>(<span class="hljs-string">"option[value='<span class="hljs-subst">#{mode}</span>']"</span>).prop(<span class="hljs-string">'selected'</span>, <span class="hljs-literal">yes</span>)

    <span class="hljs-property">@save</span>()

}</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>View containing options that allow the user to configure the Ace editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>EditorSettingsView = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>Overlay the editor settings on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#editor_settings'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>Template for setting options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">template</span>: _.template <span class="hljs-string">"""
    &lt;option value="&lt;%- ctx.value %&gt;"&gt;&lt;%= ctx.html %&gt;&lt;/option&gt;
  """</span></pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>Register DOM events for the editor settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'change #editor_indent_size'</span>:       <span class="hljs-string">'update'</span>
    <span class="hljs-string">'change #editor_line_wrap'</span>:         <span class="hljs-string">'update'</span>
    <span class="hljs-string">'change #editor_soft_tabs'</span>:         <span class="hljs-string">'update'</span>
    <span class="hljs-string">'change #editor_theme'</span>:             <span class="hljs-string">'update'</span>
    <span class="hljs-string">'click .modal-footer .btn-warning'</span>: <span class="hljs-string">'restoreDefaults'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Initialize the editor settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    $sizes  = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_indent_size'</span>)
    $themes = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_theme'</span>)

    <span class="hljs-keyword">for</span> size <span class="hljs-keyword">in</span> page.config.editor.indentSizes
      $sizes.append <span class="hljs-property">@template</span> {
        <span class="hljs-attribute">html</span>:  size
        <span class="hljs-attribute">value</span>: size
      }

    <span class="hljs-keyword">for</span> theme <span class="hljs-keyword">in</span> page.config.editor.themes
      $themes.append <span class="hljs-property">@template</span> {
        <span class="hljs-attribute">html</span>:  i18n.get(<span class="hljs-string">"editor_theme_<span class="hljs-subst">#{theme}</span>"</span>)
        <span class="hljs-attribute">value</span>: theme
      }

    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change'</span>, <span class="hljs-property">@captureAnalytics</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change'</span>, <span class="hljs-property">@render</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Capture the analytics for any changed model attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">captureAnalytics</span>:<span class="hljs-function"> -&gt;</span>
    attrs = <span class="hljs-property">@model</span>.changedAttributes() <span class="hljs-keyword">or</span> {}

    analytics.track(<span class="hljs-string">'Editor'</span>, <span class="hljs-string">'Changed'</span>, attr) <span class="hljs-keyword">for</span> attr <span class="hljs-keyword">of</span> attrs</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Render the editor settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    indentSize = <span class="hljs-property">@model</span>.get(<span class="hljs-string">'indentSize'</span>)
    lineWrap   = <span class="hljs-property">@model</span>.get(<span class="hljs-string">'lineWrap'</span>)
    softTabs   = <span class="hljs-property">@model</span>.get(<span class="hljs-string">'softTabs'</span>)
    theme      = <span class="hljs-property">@model</span>.get(<span class="hljs-string">'theme'</span>)

    <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_indent_size'</span>).val(<span class="hljs-string">"<span class="hljs-subst">#{indentSize}</span>"</span>)
    <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_line_wrap'</span>).val(<span class="hljs-string">"<span class="hljs-subst">#{lineWrap}</span>"</span>)
    <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_soft_tabs'</span>).val(<span class="hljs-string">"<span class="hljs-subst">#{softTabs}</span>"</span>)
    <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_theme'</span>).val(theme)

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Restore the attributes of underlying model to their default values.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">restoreDefaults</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@model</span>.restoreDefaults()
    <span class="hljs-property">@model</span>.save()</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>Update the state of the editor settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>:<span class="hljs-function"> -&gt;</span>
    $indentSize = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_indent_size'</span>)
    $lineWrap   = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_line_wrap'</span>)
    $softTabs   = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_soft_tabs'</span>)
    $theme      = <span class="hljs-property">@$</span>(<span class="hljs-string">'#editor_theme'</span>)

    <span class="hljs-property">@model</span>.save
      <span class="hljs-attribute">indentSize</span>: parseInt($indentSize.val(), <span class="hljs-number">0</span>)
      <span class="hljs-attribute">lineWrap</span>:   $lineWrap.val() <span class="hljs-keyword">is</span> <span class="hljs-string">'true'</span>
      <span class="hljs-attribute">softTabs</span>:   $softTabs.val() <span class="hljs-keyword">is</span> <span class="hljs-string">'true'</span>
      <span class="hljs-attribute">theme</span>:      $theme.val()

}</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Contains the Ace editor that allows the user to modify a snippet’s code.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>EditorView = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>Overlay the editor on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#editor'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Initialize the editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@ace</span> = ace.edit(<span class="hljs-string">'editor'</span>)
    <span class="hljs-property">@ace</span>.setReadOnly(<span class="hljs-keyword">not</span> <span class="hljs-property">@hasModel</span>())
    <span class="hljs-property">@ace</span>.setShowPrintMargin(<span class="hljs-literal">no</span>)
    <span class="hljs-property">@ace</span>.getSession().<span class="hljs-literal">on</span> <span class="hljs-string">'change'</span>,<span class="hljs-function"> =&gt;</span>
      <span class="hljs-property">@model</span>.trigger(<span class="hljs-string">'modified'</span>, <span class="hljs-property">@hasUnsavedChanges</span>(), <span class="hljs-property">@ace</span>.getValue()) <span class="hljs-keyword">if</span> <span class="hljs-property">@hasModel</span>()

    <span class="hljs-property">@settings</span> = <span class="hljs-keyword">new</span> EditorSettingsView({ <span class="hljs-attribute">model</span>: <span class="hljs-property">@options</span>.settings })
    <span class="hljs-property">@controls</span> = <span class="hljs-keyword">new</span> EditorControls({ <span class="hljs-property">@ace</span> })
    <span class="hljs-property">@modes</span>    = <span class="hljs-keyword">new</span> EditorModes({ <span class="hljs-property">@ace</span> })

    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@options</span>.settings, <span class="hljs-string">'change'</span>, <span class="hljs-property">@updateEditor</span>)

    <span class="hljs-property">@updateEditor</span>()</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Determine whether or not the contents of the Ace editor is different from the snippet code.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">hasUnsavedChanges</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@ace</span>.getValue() <span class="hljs-keyword">isnt</span> <span class="hljs-property">@model</span>?.get(<span class="hljs-string">'code'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>Render the editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@settings</span>.render()
    <span class="hljs-property">@controls</span>.render()
    <span class="hljs-property">@modes</span>.render()

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Update the state of the editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@model</span>)</span> -&gt;</span>
    <span class="hljs-property">@ace</span>.setReadOnly(<span class="hljs-keyword">not</span> <span class="hljs-property">@hasModel</span>())
    <span class="hljs-property">@ace</span>.setValue(<span class="hljs-property">@model</span>?.get(<span class="hljs-string">'code'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">''</span>)
    <span class="hljs-property">@ace</span>.gotoLine(<span class="hljs-number">0</span>)

    <span class="hljs-property">@settings</span>.update(<span class="hljs-property">@model</span>)
    <span class="hljs-property">@controls</span>.update(<span class="hljs-property">@model</span>)
    <span class="hljs-property">@modes</span>.update(<span class="hljs-property">@model</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Update the Ace editor with the selected options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">updateEditor</span>:<span class="hljs-function"> -&gt;</span>
    {settings} = <span class="hljs-property">@options</span>
    aceSession = <span class="hljs-property">@ace</span>.getSession()

    aceSession.setUseWrapMode(settings.get(<span class="hljs-string">'lineWrap'</span>))
    aceSession.setUseSoftTabs(settings.get(<span class="hljs-string">'softTabs'</span>))
    aceSession.setTabSize(settings.get(<span class="hljs-string">'indentSize'</span>))
    <span class="hljs-property">@ace</span>.setTheme(<span class="hljs-string">"ace/theme/<span class="hljs-subst">#{settings.get(<span class="hljs-string">'theme'</span>)}</span>"</span>)

}</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <h2 id="settings">Settings</h2>

            </div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Allows the user to modify the general settings of the extension.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>GeneralSettingsView = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Overlay the general settings on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#general_tab'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Register DOM events for the general settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'change #analytics'</span>: <span class="hljs-string">'save'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Initialize the general settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change:analytics'</span>, <span class="hljs-property">@render</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change:analytics'</span>, <span class="hljs-property">@updateAnalytics</span>)

    <span class="hljs-property">@updateAnalytics</span>()</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Render the general settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@$</span>(<span class="hljs-string">'#analytics'</span>).prop(<span class="hljs-string">'checked'</span>, <span class="hljs-property">@model</span>.get(<span class="hljs-string">'analytics'</span>))

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Save the settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">save</span>:<span class="hljs-function"> -&gt;</span>
    $analytics = <span class="hljs-property">@$</span>(<span class="hljs-string">'#analytics'</span>)

    <span class="hljs-property">@model</span>.save({ <span class="hljs-attribute">analytics</span>: $analytics.<span class="hljs-keyword">is</span>(<span class="hljs-string">':checked'</span>) })</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Add or remove analytics from the page depending on settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">updateAnalytics</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">if</span> <span class="hljs-property">@model</span>.get(<span class="hljs-string">'analytics'</span>)
      analytics.add(page.config.analytics)
      analytics.track(<span class="hljs-string">'General'</span>, <span class="hljs-string">'Changed'</span>, <span class="hljs-string">'Analytics'</span>, <span class="hljs-number">1</span>)
    <span class="hljs-keyword">else</span>
      analytics.track(<span class="hljs-string">'General'</span>, <span class="hljs-string">'Changed'</span>, <span class="hljs-string">'Analytics'</span>, <span class="hljs-number">0</span>)
      analytics.remove()

}</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Parent view for all configurable settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>SettingsView = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Overlay the settings on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'body'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Initialize the settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@general</span> = <span class="hljs-keyword">new</span> GeneralSettingsView({ <span class="hljs-property">@model</span> })</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>Render the settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@general</span>.render()

    @

}</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <h2 id="snippets">Snippets</h2>

            </div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>View contains buttons used to control/manage the user’s snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>SnippetControls = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Overlay the snippet controls on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#snippets_controls'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Register DOM events for the snippet controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'click #delete_menu .js-resolve'</span>:                          <span class="hljs-string">'removeSnippet'</span>
    <span class="hljs-string">'hide.bs.modal .modal'</span>:                                    <span class="hljs-string">'resetHost'</span>
    <span class="hljs-string">'show.bs.modal #snippet_clone_modal, #snippet_edit_modal'</span>: <span class="hljs-string">'insertHost'</span>
    <span class="hljs-string">'shown.bs.modal .modal'</span>:                                   <span class="hljs-string">'focusHost'</span>
    <span class="hljs-string">'submit #snippet_add_form'</span>:                                <span class="hljs-string">'addSnippet'</span>
    <span class="hljs-string">'submit #snippet_clone_form'</span>:                              <span class="hljs-string">'cloneSnippet'</span>
    <span class="hljs-string">'submit #snippet_edit_form'</span>:                               <span class="hljs-string">'editSnippet'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Handle the form submission to add a new snippet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">addSnippet</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    <span class="hljs-property">@submitSnippet</span>(event, <span class="hljs-string">'add'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Grant focus to the host field within the originating modal dialog.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">focusHost</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    $modal = $(event.currentTarget)

    $modal.find(<span class="hljs-string">'form :text'</span>).focus()</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Handle the form submission to clone an existing snippet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">cloneSnippet</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    <span class="hljs-property">@submitSnippet</span>(event, <span class="hljs-string">'clone'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Handle the form submission to edit an existing snippet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">editSnippet</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    <span class="hljs-property">@submitSnippet</span>(event, <span class="hljs-string">'edit'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Insert the host attribute of the selected snippet in to the field within the originating modal
dialog.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">insertHost</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    $modal = $(event.currentTarget)

    $modal.find(<span class="hljs-string">'form :text'</span>).val(<span class="hljs-property">@model</span>.get(<span class="hljs-string">'host'</span>))</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Deselect and destroy the active snippet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">removeSnippet</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">unless</span> <span class="hljs-property">@hasModel</span>()

    {model} = @
    model.deselect().done<span class="hljs-function"> -&gt;</span>
      model.destroy()</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Reset the host field within the originating modal dialog.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">resetHost</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    $modal = $(event.currentTarget)

    $modal.find(<span class="hljs-string">'form :text'</span>).val(<span class="hljs-string">''</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Handle the form submission to determine how the input should be stored based on the <code>action</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">submitSnippet</span>: <span class="hljs-function"><span class="hljs-params">(event, action)</span> -&gt;</span>
    $form  = $(event.currentTarget)
    $group = $form.find(<span class="hljs-string">'.form-group:first'</span>)
    $modal = $form.closest(<span class="hljs-string">'.modal'</span>)
    host   = $group.find(<span class="hljs-string">':text'</span>).val().replace(<span class="hljs-regexp">/\s+/g</span>, <span class="hljs-string">''</span>)

    <span class="hljs-keyword">unless</span> host
      $group.addClass(<span class="hljs-string">'has-error'</span>)
    <span class="hljs-keyword">else</span>
      $group.removeClass(<span class="hljs-string">'has-error'</span>)

      $modal.modal(<span class="hljs-string">'hide'</span>)

      <span class="hljs-keyword">if</span> action <span class="hljs-keyword">is</span> <span class="hljs-string">'edit'</span>
        <span class="hljs-property">@model</span>.save({ host })
        .done<span class="hljs-function"> -&gt;</span>
          analytics.track(<span class="hljs-string">'Snippet'</span>, <span class="hljs-string">'Renamed'</span>, host)

          page.snippets.list.sort()
      <span class="hljs-keyword">else</span>
        base = <span class="hljs-keyword">if</span> action <span class="hljs-keyword">is</span> <span class="hljs-string">'clone'</span> <span class="hljs-keyword">then</span> <span class="hljs-property">@model</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">new</span> Snippet()

        <span class="hljs-property">@collection</span>.create {
          host
          <span class="hljs-attribute">code</span>: base.get(<span class="hljs-string">'code'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">''</span>
          <span class="hljs-attribute">mode</span>: base.get(<span class="hljs-string">'mode'</span>) <span class="hljs-keyword">or</span> Snippet.defaultMode
        }, <span class="hljs-attribute">success</span>: <span class="hljs-function"><span class="hljs-params">(model)</span> -&gt;</span>
          <span class="hljs-keyword">if</span> action <span class="hljs-keyword">is</span> <span class="hljs-string">'clone'</span>
            analytics.track(<span class="hljs-string">'Snippet'</span>, <span class="hljs-string">'Cloned'</span>, base.get(<span class="hljs-string">'host'</span>))
          <span class="hljs-keyword">else</span>
            analytics.track(<span class="hljs-string">'Snippet'</span>, <span class="hljs-string">'Created'</span>, host)

          model.select().done<span class="hljs-function"> -&gt;</span>
            page.snippets.list.sort().showSelected()

    <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Update the state of the snippet controls.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@model</span>)</span> -&gt;</span>
    $modelButtons = <span class="hljs-property">@$</span>(<span class="hljs-string">'#clone_button, #edit_button, #delete_menu .btn'</span>)

    $modelButtons.prop(<span class="hljs-string">'disabled'</span>, <span class="hljs-keyword">not</span> <span class="hljs-property">@hasModel</span>())

}</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Menu item which, when selected, enables the user to manage and modify the code of the underlying
snippet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>SnippetItem = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Tag name for the element to be created for the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">tagName</span>: <span class="hljs-string">'li'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Prevent <code>activateTooltips</code> from interfering with the tooltip of the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-class">className: '<span class="hljs-title">js</span>-<span class="hljs-title">tooltip</span>-<span class="hljs-title">ignore</span>'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Template for the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">mainTemplate</span>: _.template <span class="hljs-string">"""
    &lt;a&gt;
      &lt;span&gt;&lt;%= ctx.host %&gt;&lt;/span&gt;
    &lt;/a&gt;
  """</span></pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Template for the tooltip of the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">tooltipTemplate</span>: _.template <span class="hljs-string">"""
    &lt;div class="snippet-tooltip"&gt;
      &lt;span class="snippet-tooltip-host"&gt;&lt;%= ctx.host %&gt;&lt;/span&gt;
      &lt;span class="snippet-tooltip-mode"&gt;&lt;%= i18n.get('editor_mode_' + ctx.mode) %&gt;&lt;/span&gt;
    &lt;/div&gt;
  """</span></pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Register DOM events for the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">events</span>:
    <span class="hljs-string">'click a'</span>: <span class="hljs-string">'updateSelection'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Initialize the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'destroy'</span>, <span class="hljs-property">@remove</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'modified'</span>, <span class="hljs-property">@modified</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change:host change:selected'</span>, <span class="hljs-property">@render</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@model</span>, <span class="hljs-string">'change:host change:mode'</span>, <span class="hljs-property">@updateTooltip</span>)

    <span class="hljs-property">@updateTooltip</span>()</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>Highlight that the snippet code has been modified in the editor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">modified</span>: <span class="hljs-function"><span class="hljs-params">(changed)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> changed
      <span class="hljs-property">@$el</span>.addClass(<span class="hljs-string">'modified'</span>)
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@$el</span>.removeClass(<span class="hljs-string">'modified'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>Override <code>remove</code> to ensure that the tooltip is properly destroyed upon removal.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">remove</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@$el</span>.tooltip(<span class="hljs-string">'destroy'</span>)

    <span class="hljs-property">@super</span>(<span class="hljs-string">'remove'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>Render the snippet item.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@$el</span>.html(<span class="hljs-property">@mainTemplate</span>(<span class="hljs-property">@model</span>.pick(<span class="hljs-string">'host'</span>)))

    <span class="hljs-keyword">if</span> <span class="hljs-property">@model</span>.get(<span class="hljs-string">'selected'</span>)
      <span class="hljs-property">@$el</span>.addClass(<span class="hljs-string">'active'</span>)
    <span class="hljs-keyword">else</span>
      <span class="hljs-property">@$el</span>.removeClass(<span class="hljs-string">'active modified'</span>)

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>Update the selected state of the snippet depending on the given <code>event</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">updateSelection</span>: <span class="hljs-function"><span class="hljs-params">(event)</span> -&gt;</span>
    <span class="hljs-keyword">if</span> event.ctrlKey <span class="hljs-keyword">or</span> event.metaKey <span class="hljs-keyword">and</span> <span class="hljs-regexp">/^mac/i</span>.test(navigator.platform)
      <span class="hljs-property">@model</span>.deselect()
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">unless</span> <span class="hljs-property">@$el</span>.hasClass(<span class="hljs-string">'active'</span>)
      <span class="hljs-property">@model</span>.select()</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Update the tooltip for the snippet item, destroying any previous tooltip in the process.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">updateTooltip</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@$el</span>
    .tooltip(<span class="hljs-string">'destroy'</span>)
    .tooltip {
      <span class="hljs-attribute">container</span>: <span class="hljs-string">'body'</span>
      <span class="hljs-attribute">html</span>:      <span class="hljs-literal">yes</span>
      <span class="hljs-attribute">title</span>:     <span class="hljs-property">@tooltipTemplate</span>(<span class="hljs-property">@model</span>.pick(<span class="hljs-string">'host'</span>, <span class="hljs-string">'mode'</span>))
    }

}</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>A menu of snippets that allows the user to easily manage them.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>SnippetsList = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>Overlay the snippets list on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#snippets_list'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Create and add a <code>SnippetItem</code> for the specified <code>model</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">addItem</span>: <span class="hljs-function"><span class="hljs-params">(model)</span> -&gt;</span>
    item = <span class="hljs-keyword">new</span> SnippetItem({ model })

    <span class="hljs-property">@items</span>.push(item)

    <span class="hljs-property">@$el</span>.append(item.render().$el)

    item</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Initialize the snippets list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@items</span> = []

    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@collection</span>, <span class="hljs-string">'add'</span>, <span class="hljs-property">@addItem</span>)
    <span class="hljs-property">@listenTo</span>(<span class="hljs-property">@collection</span>, <span class="hljs-string">'reset'</span>, <span class="hljs-property">@resetItems</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Override <code>remove</code> to ensure that managed sub-views are removed as well.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">remove</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@removeItems</span>()

    <span class="hljs-property">@super</span>(<span class="hljs-string">'remove'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Remove all managed sub-views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">removeItems</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@items</span>.shift().remove() <span class="hljs-keyword">while</span> <span class="hljs-property">@items</span>.length &gt; <span class="hljs-number">0</span></pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Render the snippets list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@resetItems</span>()

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <p>Remove any existing managed sub-views before creating and adding new <code>SnippetItem</code> views for
each snippet model in the collection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">resetItems</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@removeItems</span>()

    <span class="hljs-property">@collection</span>.each(<span class="hljs-property">@addItem</span>, @)</pre></div></div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              <p>Scroll to the selected snippet in the list.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">showSelected</span>:<span class="hljs-function"> -&gt;</span>
    $selectedItem = <span class="hljs-property">@$</span>(<span class="hljs-string">'li.active'</span>)

    <span class="hljs-property">@$el</span>.scrollTop($selectedItem.offset().top - <span class="hljs-property">@$el</span>.offset().top)

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>Detach each snippet item in the list and sort them based on their text contents before
re-appending them.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">sort</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@$el</span>.append(_.sortBy(<span class="hljs-property">@$</span>(<span class="hljs-string">'li'</span>).detach(), <span class="hljs-string">'textContent'</span>))

    @

}</pre></div></div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>The primary view for managing snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>SnippetsView = Injector.View.extend {</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>Overlay the snippets on top of this element.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">el</span>: <span class="hljs-string">'#snippets_tab'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Initialize the snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@controls</span> = <span class="hljs-keyword">new</span> SnippetControls({ <span class="hljs-property">@collection</span> })
    <span class="hljs-property">@list</span>     = <span class="hljs-keyword">new</span> SnippetsList({ <span class="hljs-property">@collection</span> })</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>Render the snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">render</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@controls</span>.render()
    <span class="hljs-property">@list</span>.render()

    @</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Update the state of the snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(model)</span> -&gt;</span>
    <span class="hljs-property">@controls</span>.update(model)

}</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <h2 id="miscellaneous">Miscellaneous</h2>

            </div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Activate tooltip effects, optionally only within a specific context.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-function"><span class="hljs-title">activateTooltips</span> = <span class="hljs-params">(selector)</span> -&gt;</span>
  base = $(selector <span class="hljs-keyword">or</span> <span class="hljs-built_in">document</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Reset all previously treated tooltips.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  base.find(<span class="hljs-string">'[data-original-title]:not(.js-tooltip-ignore)'</span>)
  .each<span class="hljs-function"> -&gt;</span>
    $<span class="hljs-keyword">this</span> = $(@)

    $<span class="hljs-keyword">this</span>
    .tooltip(<span class="hljs-string">'destroy'</span>)
    .attr(<span class="hljs-string">'title'</span>, $<span class="hljs-keyword">this</span>.attr <span class="hljs-string">'data-original-title'</span>)
    .removeAttr(<span class="hljs-string">'data-original-title'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>Apply tooltips to all relevant elements.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  base.find(<span class="hljs-string">'[title]:not(.js-tooltip-ignore)'</span>)
  .each<span class="hljs-function"> -&gt;</span>
    $<span class="hljs-keyword">this</span> = $(@)

    $<span class="hljs-keyword">this</span>.tooltip {
      <span class="hljs-attribute">container</span>: $<span class="hljs-keyword">this</span>.attr(<span class="hljs-string">'data-container'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'body'</span>
      <span class="hljs-attribute">placement</span>: $<span class="hljs-keyword">this</span>.attr(<span class="hljs-string">'data-placement'</span>) <span class="hljs-keyword">or</span> <span class="hljs-string">'top'</span>
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <h2 id="options-page-setup">Options page setup</h2>

            </div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Responsible for managing the options page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OptionsPage</span></span></pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>The current version of the extension.</p>
<p>This will be updated with the actual value during the page’s initialization.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">version</span>: <span class="hljs-string">''</span></pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Create a new instance of <code>OptionsPage</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">constructor</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@config</span> = {}</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <h2 id="public-functions">Public functions</h2>

            </div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Initialize the options page.</p>
<p>This will involve inserting and configuring the UI elements as well as loading the current
settings.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">init</span>:<span class="hljs-function"> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>It’s nice knowing what version is running.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    {<span class="hljs-property">@version</span>} = chrome.runtime.getManifest()</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>Load the configuration data from the file before storing it locally.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    chrome.runtime.sendMessage { <span class="hljs-attribute">type</span>: <span class="hljs-string">'config'</span> }, <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@config</span>)</span> =&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>Map the mode groups now to save the configuration data from being loaded again by
<code>Snippets.fetch</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      Snippet.mapModeGroups(<span class="hljs-property">@config</span>.editor.modeGroups)</pre></div></div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>Add the user feedback feature to the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      loadFeedback(<span class="hljs-property">@config</span>.options.userVoice)</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>Begin initialization.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      i18n.traverse()</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>Retrieve all singleton instances as well as the collection for user-created snippets.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      models.fetch <span class="hljs-function"><span class="hljs-params">(result)</span> =&gt;</span>
        {settings, editorSettings, snippets} = result</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>Create views for the important models and collections.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-property">@editor</span>   = <span class="hljs-keyword">new</span> EditorView({ <span class="hljs-attribute">settings</span>: editorSettings })
        <span class="hljs-property">@settings</span> = <span class="hljs-keyword">new</span> SettingsView({ <span class="hljs-attribute">model</span>: settings })
        <span class="hljs-property">@snippets</span> = <span class="hljs-keyword">new</span> SnippetsView({ <span class="hljs-attribute">collection</span>: snippets })</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>Render these new views.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-property">@editor</span>.render()
        <span class="hljs-property">@settings</span>.render()
        <span class="hljs-property">@snippets</span>.render()</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>Ensure that views are updated accordingly when snippets are selected/deselected.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        snippets.<span class="hljs-literal">on</span> <span class="hljs-string">'selected deselected'</span>, <span class="hljs-function"><span class="hljs-params">(snippet)</span> =&gt;</span>
          <span class="hljs-keyword">if</span> snippet.get(<span class="hljs-string">'selected'</span>) <span class="hljs-keyword">then</span> <span class="hljs-property">@update</span>(snippet) <span class="hljs-keyword">else</span> <span class="hljs-property">@update</span>()

        selectedSnippet = snippets.findWhere({ <span class="hljs-attribute">selected</span>: <span class="hljs-literal">yes</span> })
        <span class="hljs-property">@update</span>(selectedSnippet) <span class="hljs-keyword">if</span> selectedSnippet</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Ensure the current year is displayed throughout, where appropriate.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'.js-insert-year'</span>).html(<span class="hljs-string">"<span class="hljs-subst">#{<span class="hljs-keyword">new</span> Date().getFullYear()}</span>"</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>Bind tab selection event to all tabs.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        initialSnippetDisplay = initialTabChange = <span class="hljs-literal">yes</span>

        $(<span class="hljs-string">'a[data-tabify]'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>,<span class="hljs-function"> -&gt;</span>
          target  = $(@).data(<span class="hljs-string">'tabify'</span>)
          $nav    = $(<span class="hljs-string">"header.navbar .nav a[data-tabify='<span class="hljs-subst">#{target}</span>']"</span>)
          $parent = $nav.parent(<span class="hljs-string">'li'</span>)

          <span class="hljs-keyword">unless</span> $parent.hasClass(<span class="hljs-string">'active'</span>)
            $parent.addClass(<span class="hljs-string">'active'</span>).siblings().removeClass(<span class="hljs-string">'active'</span>)
            $(target).removeClass(<span class="hljs-string">'hide'</span>).siblings(<span class="hljs-string">'.tab'</span>).addClass(<span class="hljs-string">'hide'</span>)

            id = $nav.attr(<span class="hljs-string">'id'</span>)

            settings.save({ <span class="hljs-attribute">tab</span>: id })
            .<span class="hljs-keyword">then</span><span class="hljs-function"> -&gt;</span>
              <span class="hljs-keyword">unless</span> initialTabChange
                analytics.track(<span class="hljs-string">'Tabs'</span>, <span class="hljs-string">'Changed'</span>, _.capitalize(id.match(<span class="hljs-regexp">/(\S*)_nav$/</span>)[<span class="hljs-number">1</span>]))

              <span class="hljs-keyword">if</span> id <span class="hljs-keyword">is</span> <span class="hljs-string">'snippets'</span> <span class="hljs-keyword">and</span> initialSnippetDisplay
                initialSnippetDisplay = <span class="hljs-literal">no</span>
                page.snippets.list.showSelected()

              initialTabChange = <span class="hljs-literal">no</span>

              $(<span class="hljs-built_in">document</span>.body).scrollTop(<span class="hljs-number">0</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Reflect the previously persisted tab initially.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">"#<span class="hljs-subst">#{settings.get <span class="hljs-string">'tab'</span>}</span>"</span>).trigger(<span class="hljs-string">'click'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>Ensure that form submissions don’t reload the page.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'form.js-no-submit'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'submit'</span>,<span class="hljs-function"> -&gt;</span> <span class="hljs-literal">false</span></pre></div></div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>Support <em>goto</em> navigation elements that change the current scroll position when clicked.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'[data-goto]'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>,<span class="hljs-function"> -&gt;</span>
          <span class="hljs-keyword">switch</span> $(@).data(<span class="hljs-string">'goto'</span>)
            <span class="hljs-keyword">when</span> <span class="hljs-string">'top'</span> <span class="hljs-keyword">then</span> $(<span class="hljs-built_in">document</span>.body).scrollTop(<span class="hljs-number">0</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p>Bind analytical tracking events to key footer buttons and links.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'footer a[href*="neocotic.com"]'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>,<span class="hljs-function"> -&gt;</span>
          analytics.track(<span class="hljs-string">'Footer'</span>, <span class="hljs-string">'Clicked'</span>, <span class="hljs-string">'Homepage'</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>Setup and configure donation buttons.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $(<span class="hljs-string">'#donation input[name="hosted_button_id"]'</span>).val(<span class="hljs-property">@config</span>.options.payPal)
        $(<span class="hljs-string">'.js-donate'</span>).<span class="hljs-literal">on</span> <span class="hljs-string">'click'</span>,<span class="hljs-function"> -&gt;</span>
          $(@).tooltip(<span class="hljs-string">'hide'</span>)

          $(<span class="hljs-string">'#donation'</span>).submit()

          analytics.track(<span class="hljs-string">'Donate'</span>, <span class="hljs-string">'Clicked'</span>)

        activateTooltips()</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>Update the primary views with the selected <code>snippet</code> provided.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">update</span>: <span class="hljs-function"><span class="hljs-params">(snippet)</span> -&gt;</span>
    <span class="hljs-property">@editor</span>.update(snippet)
    <span class="hljs-property">@snippets</span>.update(snippet)</pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <p>Create an global instance of <code>OptionsPage</code> and initialize it once the DOM is ready.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>page = <span class="hljs-built_in">window</span>.page = <span class="hljs-keyword">new</span> OptionsPage()

$<span class="hljs-function"> -&gt;</span> page.init()</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
